# Malware Scanner

[![CI](https://github.com/sss-ng/malware-scanner/actions/workflows/main.yml/badge.svg)](https://github.com/sss-ng/malware-scanner/actions/workflows/main.yml)

## Overview

Malware Scanner is a Python-based tool designed to scan files in a specified directory using the ClamAV open-source dataset of virus signatures. This tool employs hashing algorithms such as MD5 and SHA-1 to identify potential viruses based on their signatures.

## Setup

1. **ClamAV Dataset:**
   - The virus signatures dataset is obtained from ClamAV at [https://database.clamav.net/main.cvd](https://database.clamav.net/main.cvd).

2. **Hashing Algorithms:**
   - ClamAV uses two hashing algorithms for virus signatures: MD5 (32 characters) and SHA-1 (40 characters).

## Usage

To install and run the Malware Scanner software, execute the following command in your terminal:

```bash
python3 -m pip install pipenv
pipenv install --dev

# first download the dataset
pipenv run python main.py --download-dataset

# then search
pipenv run python main.py --search-dirs /tmp/ --verbose
```

Run it with `-h` or `--help` to view the help
```bash
$ pipenv run python main.py -h

usage: main.py [-h] [--fetch-dataset] [--search-dirs SEARCH_DIRS [SEARCH_DIRS ...]] [--max-file-size MAX_FILE_SIZE]
               [--exclude-dirs EXCLUDE_DIRS [EXCLUDE_DIRS ...]] [--verbose]

Malware Scanner using ClamAV dataset.

options:
  -h, --help            show this help message and exit
  --fetch-dataset       Fetch the ClamAV dataset and extract it.
  --search-dirs SEARCH_DIRS [SEARCH_DIRS ...]
                        Specify the directory to scan for viruses.
  --max-file-size MAX_FILE_SIZE
                        Skip files larger than the specified size (in MB).
  --exclude-dirs EXCLUDE_DIRS [EXCLUDE_DIRS ...]
                        Specify directories to exclude from scanning.
  --verbose             Log each file scanned
```

The output will display the progress of scanning files in the specified directory, and a summary will indicate whether any viruses were found. Here is an example output:
```
100%|███████████████████████████████████████████████████████████| 35516/35516 [00:04<00:00, 7225.86it/s]
No viruses were found.
The number of files scanned were 35516.
The number of virus signatures in the database is 82210.
```

This indicates the number of files scanned, the absence of viruses, and the total number of virus signatures in the database